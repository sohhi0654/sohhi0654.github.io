<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<title>Azaponのプラティ水槽</title>
<link rel="icon" href="images/azarasi.png" type="image/png">
<style>
  body {
    margin: 0;
    height: 100vh;
    background: radial-gradient(circle at 50% 30%, #a0e0ff, #0077aa);
    overflow: hidden;
    font-family: "Segoe UI", sans-serif;
    color: white;
  }

  .particle {
    position: absolute;
    width: 10px;
    height: 10px;
    background: radial-gradient(circle, rgba(255,255,255,0.8), transparent);
    border-radius: 50%;
    animation: float 10s infinite linear;
  }

  @keyframes float {
    0% { transform: translateY(100vh) translateX(0) scale(0.5); opacity: 0.3; }
    50% { opacity: 1; }
    100% { transform: translateY(-10vh) translateX(100px) scale(1); opacity: 0.3; }
  }

  .fish {
    position: absolute;
    width: 50px;
    animation: swim 6s infinite linear;
  }

  @keyframes swim {
    0% { left: -60px; top: 30%; }
    50% { left: 80%; top: 50%; }
    100% { left: -60px; top: 30%; }
  }

  .temp-box {
    position: absolute;
    top: 20px;
    left: 50%;
    transform: translateX(-50%);
    background: rgba(0, 128, 255, 0.6);
    border-radius: 12px;
    padding: 20px 40px;
    font-size: 2em;
    text-align: center;
    box-shadow: 0 0 20px #00ffff;
  }

  .safe { color: #ffff66; }   /* 黄色系 */
  .warning { color: #ff6600; } /* オレンジ系 */
</style>
</head>
<body>

<div class="temp-box" id="tempDisplay">温度: -- °C</div>

<img src="images/azarasi.png" class="fish" style="top: 40%; animation-duration: 8s;">
<img src="images/azarasi.png" class="fish" style="top: 60%; animation-duration: 10s;">

<script type="module">
  // --- Firebase SDK ---
  import { initializeApp } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-app.js";
  import { getDatabase, ref, onValue } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-database.js";

  const firebaseConfig = {
    apiKey: "AIzaSyDUA7LwBaBupLcYMu-kzk7Hcv486IDiO8w",
    authDomain: "azapon-temp-monitor.firebaseapp.com",
    databaseURL: "https://azapon-temp-monitor-default-rtdb.firebaseio.com/",
    projectId: "azapon-temp-monitor",
    storageBucket: "azapon-temp-monitor.appspot.com",
    messagingSenderId: "802815899884",
    appId: "1:802815899884:web:be30065f2c815ad8dc0dc9",
    measurementId: "G-RX0VL63N7G"
  };

  const app = initializeApp(firebaseConfig);
  const db = getDatabase(app);

  const tempDisplay = document.getElementById('tempDisplay');

  // --- Firebaseからリアルタイム取得 ---
  const tempRef = ref(db, 'temperature'); // Pi側で /temperature に送信する想定
  onValue(tempRef, (snapshot) => {
    const temp = snapshot.val();
    tempDisplay.textContent = `温度: ${temp.toFixed(1)} °C`;
    if(temp < 22 || temp > 28) tempDisplay.className = 'temp-box warning';
    else tempDisplay.className = 'temp-box safe';
  });

  // --- 光の粒を生成 ---
  const particleCount = 30;
  for(let i=0;i<particleCount;i++){
    let p = document.createElement('div');
    p.className = 'particle';
    p.style.left = Math.random()*100 + 'vw';
    p.style.animationDelay = (Math.random()*10)+'s';
    p.style.width = 5 + Math.random()*10 + 'px';
    p.style.height = p.style.width;
    document.body.appendChild(p);
  }
</script>

</body>
</html>
